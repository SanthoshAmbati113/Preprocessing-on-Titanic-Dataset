# -*- coding: utf-8 -*-
"""Untitled23.ipynb

Automatically generated by Colab.

Original file is located at
    https://colab.research.google.com/drive/1ir-_dqs1D6atMRCLmJyL922-lExc-fnB
"""

import pandas as pd



df=pd.read_csv('Titanic-Dataset.csv',index_col='PassengerId')

df.head()

df.info()
df.isnull().sum()

df['Age'].fillna(df['Age'].mean(),inplace=True)
df.isnull().sum()

df['Cabin'].fillna('Unknown',inplace=True)
df['Embarked'].fillna(df['Embarked'].mode(),inplace=True)

df.isnull().sum()

df = pd.get_dummies(df, columns=['Sex', 'Embarked'], drop_first=True)

df.head()

from sklearn.preprocessing import StandardScaler

num_cols = ['Age', 'Fare', 'SibSp', 'Parch']
scaler = StandardScaler()
df[num_cols] = scaler.fit_transform(df[num_cols])
df.sample(5)

import seaborn as sns
import matplotlib.pyplot as plt

for col in num_cols:
    plt.figure(figsize=(6, 3))
    sns.boxplot(x=df[col])
    plt.title(f'Boxplot for {col}')
    plt.show()

# Function to remove outliers using IQR
def remove_outliers(df, cols):
    for col in cols:
        Q1 = df[col].quantile(0.25)
        Q3 = df[col].quantile(0.75)
        IQR = Q3 - Q1
        lower_bound = Q1 - 1.5 * IQR
        upper_bound = Q3 + 1.5 * IQR
        df = df[(df[col] >= lower_bound) & (df[col] <= upper_bound)]
    return df

# Remove outliers
df = remove_outliers(df, num_cols)

for col in num_cols:
    plt.figure(figsize=(6, 3))
    sns.boxplot(x=df[col])
    plt.title(f'Boxplot for {col}')
    plt.show()